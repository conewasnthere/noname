function sleep(e){return new Promise(n=>setTimeout(n,e))}function registerPresence(){let e=fetch("/app/presence");e.json,console.log("[Presence] Registered presence.")}async function buySlot(){let e=document.getElementById("modal-buy-button"),n=document.getElementById("modal-message");document.getElementById("modal-container");let t=n.innerHTML;n.innerHTML="Purchasing slot...",e.disabled=!0;try{let a=await fetch("/app/buy-slot"),r=await a.json();a.ok?!0===r.success?(n.innerHTML=r.message,e.remove(),console.log("[PaymentModule] - payment finished ok refreshing!!!"),e.remove()):!1===r.success&&(n.innerHTML=r.message,await sleep(5e3),n.innerHTML=t,e.disabled=!1):(console.log("[PaymentModule] - failed to buy slot, http error"),n.innerHTML="Failed to purchase slot. Please try again.",e.disabled=!1,await sleep(5e3),n.innerHTML=t)}catch(i){console.log("[PaymentModule] - error:",i),n.innerHTML="Failed to buy slot. Please try again later.",e.disabled=!1}}async function buyItem(e){let n=document.getElementById("modal-buy-button"),t=document.getElementById("modal-message"),a=(document.getElementById("modal-container"),document.getElementById("modal-customize-button")),r=t.innerHTML;t.innerHTML="Purchasing items...",n.disabled=!0;let i=`/app/buy-item/${e}`;try{let s=await fetch(i),o=await s.json();s.ok?!0===o.success?(t.innerHTML=o.message,n.remove(),console.log("[PaymentModule] - payment finished ok refreshing!!!"),a.classList.remove("hidden")):!1===o.success&&(t.innerHTML=o.message,await sleep(5e3),t.innerHTML=r,n.disabled=!1):(console.log("[PaymentModule] - failed to buy item, http error"),t.innerHTML="Failed to purchase item. Please try again.",n.disabled=!1,await sleep(5e3),t.innerHTML=r)}catch(l){console.log("[PaymentModule] - error:",l),t.innerHTML="Failed to buy item. Please try again later.",n.disabled=!1}}function parseDescription(){let e=document.getElementById("description-parse").innerHTML.replace(/#W/g,"<br>");e=(e=e.replace(/#B (.+?) #\/B/g,"<b>$1</b>")).replace(/#I (.+?) #\/I/g,"<i>$1</i>"),document.getElementById("description-parse").innerHTML=e,console.log(e)}function refresh(){return console.log("[functionsjs] - refreshing page!!!!!!!!!"),location.reload()}function abbreviate(e,n,t,a){var r;return(e=Number(e),!1!==(a=a||!1))?annotate(e,n,t,a):(r=e>=1e12?"T":e>=1e9?"B":e>=1e6?"M":e>=1e3?"K":"",annotate(e,n,t,r))}function annotate(e,n,t,a){var r=0;switch(a){case"T":r=e/1e12;break;case"B":r=e/1e9;break;case"M":r=e/1e6;break;case"K":r=e/1e3;break;case"":r=e}return!1!==n&&RegExp("\\.\\d{"+(n+1)+",}$").test(""+r)&&(r=r.toFixed(n)),!1!==t&&(r=Number(r).toFixed(t)),r+a}function parseForum(){let e=document.getElementById("forum-parse");e&&(e.innerHTML=e.innerHTML.replace(/#misinformation/g,'<img src="/images/misinformation.gif" width="100"><br>')),document.querySelectorAll('[id^="forum-reply-"]').forEach(function(e){e.innerHTML=e.innerHTML.replace(/#misinformation/g,'<img src="/images/misinformation.gif" width="100"><br>')})}function disableButton(e){e.disabled=!0}document.addEventListener("DOMContentLoaded",()=>{let e=document.querySelectorAll(".lazy-load");e.forEach(e=>{let n=e.getAttribute("data-src");function t(){let t=new Image;t.src=n,t.onload=()=>{e.src=n},t.onerror=()=>{console.error(`couldnt load image: ${n}`),"/app/places"===document.location.pathname?e.src="/images/no_thumbnail.png":e.src="/images/confused.png"}}t()})}),setInterval(registerPresence,3e5),registerPresence();